%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Bibliography Setup
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[backend=biber, style=apa]{biblatex} % loads APA style with biber
\addbibresource{ref.bib} % add your bibliography file

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hyperlink & URL Configuration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=black,
  urlcolor=black,
  citecolor=black,
  pdfauthor={Daniel Fischer},
  pdftitle={Master Thesis: Digital Twins},
  pdfsubject={Master Thesis},
  pdfkeywords={Digital Twin, Validation, Simulation}
}
\usepackage{cleveref} % For clever references
\usepackage{url} % URL formatting
\usepackage[toc,page]{appendix}

%% Customization for \autoref to display capitalized reference names
\providecommand{\chapterautorefname}{Chapter}
\providecommand{\sectionautorefname}{Section}
\providecommand{\subsectionautorefname}{Section}
\providecommand{\subsubsectionautorefname}{Section}
\providecommand{\figureautorefname}{Figure}
\providecommand{\tableautorefname}{Table}
\providecommand{\appendixautorefname}{Appendix}
\providecommand{\equationautorefname}{Equation}
\providecommand{\algorithmautorefname}{Algorithm}
\providecommand{\lstlistingautorefname}{Listing}
\providecommand{\theoremautorefname}{Theorem}
\providecommand{\lemmaautorefname}{Lemma}
\providecommand{\definitionautorefname}{Definition}

\renewcommand{\chapterautorefname}{Chapter}
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Section}
\renewcommand{\subsubsectionautorefname}{Section}
\renewcommand{\figureautorefname}{Figure}
\renewcommand{\tableautorefname}{Table}
\renewcommand{\appendixautorefname}{Appendix}
\renewcommand{\equationautorefname}{Equation}
\renewcommand{\algorithmautorefname}{Algorithm}
\renewcommand{\lstlistingautorefname}{Listing}
\renewcommand{\theoremautorefname}{Theorem}
\renewcommand{\lemmaautorefname}{Lemma}
\renewcommand{\definitionautorefname}{Definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Floating Objects and Graphics
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{placeins} % Force float barriers
\usepackage{graphicx} % For graphic inclusion
\graphicspath{{.}}    % Set graphics path
\usepackage{float}   % Better control of float positions
\usepackage{rotating}
% TikZ and PGF for drawing diagrams and figures
\usepackage{tikz}
\usepackage{svg} % For including SVG graphics
\usetikzlibrary{positioning, arrows.meta, plotmarks, arrows, shapes.geometric, calc, shapes, backgrounds, fit, patterns, shapes.multipart, decorations.pathreplacing, decorations.pathmorphing, decorations.text, shapes.symbols, shadows.blur, shadows} % TikZ libraries
% Define some styles for consistency
\tikzstyle{block} = [rectangle, draw, thick, fill=blue!10, text centered, rounded corners, minimum height=2.7em, minimum width=3.5em]
\tikzstyle{gate} = [circle, draw, thick, fill=yellow!30, minimum size=1.8em, inner sep=1pt]
\tikzstyle{pointop} = [circle, draw, thick, fill=green!30, inner sep=0pt, minimum size=0.9em] % Pointwise operations
\tikzstyle{data} = [coordinate] % Invisible points for routing lines
\tikzstyle{arrow} = [thick, ->, >=Stealth]
\tikzstyle{line} = [thick]
\tikzstyle{state_line} = [line width=1.5pt] % Thicker line for cell state
\usepackage{changepage}
% Add to preamble (main.tex or similar)
% Add to preamble
% Add to preamble (main.tex or similar)
\usepackage{amssymb} % Ensures the diamond symbol is available
\newcommand{\ai}[1]{#1\textsuperscript{â—Š}}

% Configure float placement to be more aggressive
\renewcommand{\topfraction}{0.9}    % Max fraction of page for floats at top
\renewcommand{\bottomfraction}{0.9} % Max fraction of page for floats at bottom
\renewcommand{\textfraction}{0.1}   % Min fraction of page for text
\renewcommand{\floatpagefraction}{0.7} % Min fraction of page that should have floats

% Make LaTeX less fussy about float placement
\setcounter{topnumber}{4}    % Max number of floats at top of page
\setcounter{bottomnumber}{4} % Max number of floats at bottom of page
\setcounter{totalnumber}{10} % Max total number of floats on a page

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Tables, Algorithms, and Miscellaneous Packages
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{booktabs}      % For professional tables
\usepackage{tabularx}      % For flexible table widths
\usepackage{algorithm}     % For algorithms
\usepackage{algpseudocode} % For pseudocode
\usepackage{comment}       % To comment out blocks of text
\usepackage{geometry}
\usepackage{pgf-pie}
\usepackage{xcolor}
\usepackage{verbatim}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{makeidx}
\pgfplotsset{compat=1.17}
\usepackage{longtable}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Mathematics and Fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsfonts} % Blackboard math symbols
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{nicefrac} % Compact slash fractions
\usepackage{anyfontsize} % Allows any font size
\usepackage{fontspec}
\usepackage{mathtools}
\setmainfont{Times New Roman}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Microtypography & Page Layout 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{microtype}    % Micro-optimizations for typography
\usepackage{fancyhdr}     % Header and footer settings
\usepackage{parskip}      % No paragraph indenting
\raggedbottom            % Disable vertical stretch to fill pages

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Table of Contents Customization (TOC)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{tocloft}
\renewcommand{\contentsname}{\fontspec{Times New Roman}Contents}
\renewcommand{\listfigurename}{\fontspec{Times New Roman}List of Figures}
\renewcommand{\listtablename}{\fontspec{Times New Roman}List of Tables}
\renewcommand{\glossaryname}{\fontspec{Times New Roman}List of Abbreviations}

\setlength{\cftbeforechapskip}{1.5em}
\renewcommand{\cftchapfont}{\fontspec{Times New Roman}\bfseries\Large}
\renewcommand{\cftchappagefont}{\fontspec{Times New Roman}\bfseries\Large}
\setlength{\cftchapnumwidth}{3em}
\renewcommand{\cftchapleader}{\hfill\mbox{\rule[0.5ex]{1cm}{0.4pt}}}

\renewcommand{\cfttoctitlefont}{\normalfont\Huge\bfseries\fontspec{Times New Roman}}
\renewcommand{\cftloftitlefont}{\normalfont\Huge\bfseries\fontspec{Times New Roman}}
\renewcommand{\cftlottitlefont}{\normalfont\Huge\bfseries\fontspec{Times New Roman}}

\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecfont}{\fontspec{Times New Roman}\normalfont\large}
\renewcommand{\cftsecpagefont}{\fontspec{Times New Roman}\normalfont\large}
\setlength{\cftbeforesecskip}{0.7em}
\setlength{\cftsecindent}{2em}

\renewcommand{\cftsubsecleader}{\hfill}
\setlength{\cftsubsecindent}{3em}
\renewcommand{\cftsubsecfont}{\fontspec{Times New Roman}\normalfont\small}
\renewcommand{\cftsubsecpagefont}{\fontspec{Times New Roman}\normalfont\small}
% Add this after your other tocloft settings
\setlength{\cftaftertoctitleskip}{1em} % Adjust this value as needed
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Captions Configuration
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{caption}
\captionsetup{font=small, labelfont=bf, skip=5pt}

%% For code listings, using listings package instead of minted
\usepackage{listings}
\lstset{
  basicstyle=\footnotesize\ttfamily,
  breaklines=true,
  frame=lines,
  numbers=left,
  numberstyle=\tiny,
  numbersep=5pt,
  tabsize=4,
  commentstyle=\color{green!50!black},
  keywordstyle=\color{blue},
  stringstyle=\color{red},
  showstringspaces=false
}
